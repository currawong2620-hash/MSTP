# üß© –ü–£–ù–ö–¢ 2 ‚Äî –¢–ò–ü–´ –î–ê–ù–ù–´–• –ò –ö–û–ù–¢–†–ê–ö–¢–´

## Architecture Data Flow Model v1.0

**Status:** FIXED
**Scope:** System-wide
**Level:** Role interaction contracts
**Change policy:** versioned only

---

## 0. –ü—Ä–∏–Ω—Ü–∏–ø –ø—É–Ω–∫—Ç–∞ 2 (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)

–í —Å–∏—Å—Ç–µ–º–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç **–∫–æ–Ω–µ—á–Ω—ã–π, –∑–∞–∫—Ä—ã—Ç—ã–π –Ω–∞–±–æ—Ä —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö**,
—á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ **–í–°–ï —Ä–æ–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç**.

–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ **–Ω–µ –æ–ø–∏—Å–∞–Ω—ã –∑–¥–µ—Å—å** ‚Äî
–∏—Ö **–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

---

## 1. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

–í —Å–∏—Å—Ç–µ–º–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è **–¢–û–õ–¨–ö–û** —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –ø–æ—Ç–æ–∫–æ–≤:

1. `Snapshot`
2. `Intent`
3. `PolicyAdjustedIntent`
4. `Decision`
5. `ExecutionResult`
6. `Feedback`

–î—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ **–ù–ï –ë–£–î–ï–¢**.

---

## 2. `Snapshot` ‚Äî —Å–Ω–∏–º–æ–∫ –º–∏—Ä–∞

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–§–∏–∫—Å–∏—Ä—É–µ—Ç **–Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∏—Ä–∞** –Ω–∞ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

### –°–æ–∑–¥–∞—ë—Ç—Å—è

* **–¢–û–õ–¨–ö–û —Ä–æ–ª—å—é:** `Observer`

### –ß–∏—Ç–∞–µ—Ç—Å—è

* `Decision Maker`
* `PositionPolicyManager MAY read:
	Snapshot.position.*
	Snapshot.market.bid
	Snapshot.market.ask
	ONLY for exit / lifecycle policies.
	Snapshot.position.trailing_stop_price
–¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è exit / lifecycle policies
* `Risk / Arbiter Policy`

### –ù–µ —á–∏—Ç–∞–µ—Ç—Å—è

* `Executor`
* `Feedback Source`
*  DecisionMaker still MAY NOT read market prices

### –°–≤–æ–π—Å—Ç–≤–∞ (–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ)

* immutable (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π)
* data-only
* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫–∏
* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–æ–∫ –Ω–∞ –≤–Ω–µ—à–Ω—é—é —Å—Ä–µ–¥—É
* –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç **–æ–¥–∏–Ω –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏**

### –°–æ–¥–µ—Ä–∂–∏—Ç (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ, –Ω–µ –ø–æ –ø–æ–ª—è–º)

* —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä—ã–Ω–∫–∞
* –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
* –≤–Ω–µ—à–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å—Ä–µ–¥—ã

---

## 3. `Intent` ‚Äî –Ω–∞–º–µ—Ä–µ–Ω–∏–µ

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–í—ã—Ä–∞–∂–∞–µ—Ç **–∂–µ–ª–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è**, –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—â–µ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

### –°–æ–∑–¥–∞—ë—Ç—Å—è

* **–¢–û–õ–¨–ö–û —Ä–æ–ª—å—é:** `Decision Maker`

### –ß–∏—Ç–∞–µ—Ç—Å—è

* `Position Policy Manager`

### –ù–µ —á–∏—Ç–∞–µ—Ç—Å—è

* `Executor`
* `Observer`

### –°–≤–æ–π—Å—Ç–≤–∞

* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç SL/TP
* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—ä—ë–º–æ–≤ –∫–∞–∫ –º–µ—Ö–∞–Ω–∏–∫–∏
* –æ–ø–∏—Å—ã–≤–∞–µ—Ç *—á—Ç–æ —Ö–æ—á—É*, –∞ –Ω–µ *–∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å*

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–π (–∑–∞–∫—Ä—ã—Ç—ã–π –Ω–∞–±–æ—Ä)

* NO_ACTION
* WANT_OPEN (directional)
* WANT_CLOSE
* WANT_HOLD

*(—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ ‚Äî —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π)*

---

## 4. `PolicyAdjustedIntent` ‚Äî –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –ø–æ—Å–ª–µ –º–µ—Ç–æ–¥–∏–∫–∏

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è **–ø–æ–ª–∏—Ç–∏–∫–∏ –≤–ª–∞–¥–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–µ–π**.

### –°–æ–∑–¥–∞—ë—Ç—Å—è

* **–¢–û–õ–¨–ö–û —Ä–æ–ª—å—é:** `Position Policy Manager`

### –ß–∏—Ç–∞–µ—Ç—Å—è

* `Risk / Arbiter Policy`

### –ù–µ —á–∏—Ç–∞–µ—Ç—Å—è

* `Decision Maker`
* `Executor`

### –°–≤–æ–π—Å—Ç–≤–∞

* –º–æ–∂–µ—Ç –±—ã—Ç—å:

  * –ø—É—Å—Ç—ã–º
  * –æ–¥–∏–Ω–æ—á–Ω—ã–º
  * –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º (0..N)
* –º–æ–∂–µ—Ç –±—ã—Ç—å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä—ã–Ω–æ—á–Ω–æ–π –ª–æ–≥–∏–∫–∏


### –í–∞–∂–Ω–æ

Decision Maker **–ù–ò–ö–û–ì–î–ê** –Ω–µ –≤–∏–¥–∏—Ç —ç—Ç–æ—Ç —Ç–∏–ø –æ–±—Ä–∞—Ç–Ω–æ.

---

## 5. `Decision` ‚Äî –¥–æ–ø—É—Å–∫ / –æ—Ç–∫–∞–∑

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–§–∏–∫—Å–∏—Ä—É–µ—Ç **—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–ø—Ä–µ—Ç** –¥–µ–π—Å—Ç–≤–∏—è.

### –°–æ–∑–¥–∞—ë—Ç—Å—è

* **–¢–û–õ–¨–ö–û —Ä–æ–ª—å—é:** `Risk / Arbiter Policy`

### –ß–∏—Ç–∞–µ—Ç—Å—è

* `Executor`

### –ù–µ —á–∏—Ç–∞–µ—Ç—Å—è

* `Decision Maker`
* `Position Policy Manager`

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–µ—à–µ–Ω–∏–π (–∑–∞–∫—Ä—ã—Ç—ã–π –Ω–∞–±–æ—Ä)

* ACCEPT
* REJECT
* MODIFY

### –°–≤–æ–π—Å—Ç–≤–∞

* –Ω–µ –æ–±—ä—è—Å–Ω—è–µ—Ç *–ø–æ—á–µ–º—É*
* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–∏
* –º–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç–∏

---

## 6. `ExecutionResult` ‚Äî —Ñ–∞–∫—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–§–∏–∫—Å–∏—Ä—É–µ—Ç **–¢–û–õ–¨–ö–û —Ñ–∞–∫—Ç—ã**, –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–∏–µ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

### –°–æ–∑–¥–∞—ë—Ç—Å—è

* **–¢–û–õ–¨–ö–û —Ä–æ–ª—å—é:** `Executor`

### –ß–∏—Ç–∞–µ—Ç—Å—è

* `Feedback Source`

### –ù–µ —á–∏—Ç–∞–µ—Ç—Å—è

* `Decision Maker`
* `Risk Policy`

### –°–≤–æ–π—Å—Ç–≤–∞

* —Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π
* –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–π
* –º–æ–∂–µ—Ç –æ—Ç—Ä–∞–∂–∞—Ç—å:

  * —É—Å–ø–µ—Ö
  * –æ—Ç–∫–∞–∑
  * —á–∞—Å—Ç–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ
  * –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

---

## 7. `Feedback` ‚Äî –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–î–æ–≤–æ–¥–∏—Ç –¥–æ Decision Maker **—Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ—à–ª—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π**
–≤ —Ñ–æ—Ä–º–µ, –ø—Ä–∏–≥–æ–¥–Ω–æ–π –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

### –°–æ–∑–¥–∞—ë—Ç—Å—è

* **–¢–û–õ–¨–ö–û —Ä–æ–ª—å—é:** `Feedback Source`

### –ß–∏—Ç–∞–µ—Ç—Å—è

* `Decision Maker`
* `Position Policy Manager`

### –ù–µ —á–∏—Ç–∞–µ—Ç—Å—è

* `Observer`
* `Executor`

### –°–≤–æ–π—Å—Ç–≤–∞

* –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
* –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∫—É –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
* –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∞ –Ω–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å

---

## 8. –ü–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ)

```
Observer
   ‚Üí Snapshot
Decision Maker
   ‚Üí Intent
Position Policy Manager
   ‚Üí PolicyAdjustedIntent(s)
Risk / Arbiter Policy
   ‚Üí Decision
Executor
   ‚Üí ExecutionResult
Feedback Source
   ‚Üí Feedback
      ‚Ü∫ (–∫ Decision Maker)
```

–õ—é–±–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —ç—Ç–æ–≥–æ –ø–æ—Ç–æ–∫–∞ ‚Äî
**–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ**.

---

## 9. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–µ—Ç—ã (—á–∞—Å—Ç—å –ü—É–Ω–∫—Ç–∞ 2)

* ‚ùå Strategy / Decision Maker –Ω–µ –≤–∏–¥–∏—Ç ExecutionResult –Ω–∞–ø—Ä—è–º—É—é
* ‚ùå Strategy –Ω–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ PolicyAdjustedIntent
* ‚ùå Executor –Ω–µ —á–∏—Ç–∞–µ—Ç Intent
* ‚ùå Observer –Ω–µ –∑–Ω–∞–µ—Ç –æ –Ω–∞–º–µ—Ä–µ–Ω–∏—è—Ö
* ‚ùå Feedback –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

---

## 10. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Å–ª–µ–¥—Å—Ç–≤–∏–µ (–æ—á–µ–Ω—å –≤–∞–∂–Ω–æ)

–ö–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö:

* **–º–æ–∂–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å**
* **–º–æ–∂–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å**
* **–º–æ–∂–Ω–æ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å**
* **–º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ**

üëâ –≠—Ç–æ **–ø—Ä—è–º–æ–µ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–µ—Ä–æ–≤**.

---

## 11. –°—Ç–∞—Ç—É—Å —Ñ–∏–∫—Å–∞—Ü–∏–∏

* –Ω–∞–±–æ—Ä —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å—á–∏—Ç–∞–µ—Ç—Å—è **–∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–º**
* —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ ‚Äî **–¢–û–õ–¨–ö–û –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π**
* —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥—á–∏–Ω—è–µ—Ç—Å—è —ç—Ç–æ–º—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É

---

**END OF DATA FLOW MODEL**
