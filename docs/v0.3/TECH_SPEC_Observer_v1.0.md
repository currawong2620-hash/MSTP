# üü• TECH SPEC ‚Äî Observer v1.0 (REVISED)

**–ü—Ä–æ–µ–∫—Ç:** Trading Platform (MQL5)
**–ü–æ–¥—Å–∏—Å—Ç–µ–º–∞:** Infrastructure
**–†–æ–ª—å:** `Observer`
**–í–µ—Ä—Å–∏—è:** v1.0
**–°—Ç–∞—Ç—É—Å:** Draft ‚Üí Master-Chat approval
**–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è:**
SSP v1.0, CONTRACT_LEXICON v1.0, NAMING_RULES v1.0,
ROLE_CALL_CONTRACTS v0.1, Architecture Data Flow Model v1.0,
Visual Observability Model v1.0

---

## 0. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

`Observer v1.0` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç **—á–µ—Å—Ç–Ω—ã–π Snapshot** ‚Äî
—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ä–µ–¥—ã MT5 **–±–µ–∑ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏**.

Observer –æ—Ç—Ä–∞–∂–∞–µ—Ç **–¢–û–õ–¨–ö–û —Ç–æ, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –Ω–∞–±–ª—é–¥–∞–µ–º–æ**
–∏ **–ù–ò–ö–û–ì–î–ê –Ω–µ –ø–æ–¥–º–µ–Ω—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏**.

---

## 1. –ü—É–±–ª–∏—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω)

```mq5
void Observer_Run(
    Snapshot &out_snapshot
);
```

–ö–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º.

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (—É—Ç–æ—á–Ω–µ–Ω—ã)

Observer **–û–ë–Ø–ó–ê–ù**:

* —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω `Snapshot` –Ω–∞ –≤—ã–∑–æ–≤
* –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø–æ–ª—è **–¢–û–õ–¨–ö–û —Ñ–∞–∫—Ç–∞–º–∏**, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ MT5
* –Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å, –Ω–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å, –Ω–µ ‚Äú—É–ª—É—á—à–∞—Ç—å‚Äù –¥–∞–Ω–Ω—ã–µ
* –±—ã—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å—Ä–µ–¥—ã

Observer **–ó–ê–ü–†–ï–©–ï–ù–û**:

* —á–∏—Ç–∞—Ç—å –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç–∏–ø—ã
* –≤—ã—á–∏—Å–ª—è—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
* –≤–≤–æ–¥–∏—Ç—å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äú–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞‚Äù
* –≤—ã–≤–æ–¥–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–ª–∏ —Ä–∏—Å–∫–∞

---

## 3. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Snapshot (–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ)

Observer **–∑–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –ø–æ–ª—è**, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –≤ Lexicon,
**–ù–û –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ø—É—Å—Ç–∏–º—ã –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º–∏ —Ñ–∞–∫—Ç–∞–º–∏**.

---

### 3.1 `Snapshot.market`

–ò—Å—Ç–æ—á–Ω–∏–∫: MT5 market data.

| –ü–æ–ª–µ                | –ü—Ä–∞–≤–∏–ª–æ                                            |
| ------------------- | -------------------------------------------------- |
| open/high/low/close | –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ MT5 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞—Ä** |
| volume              | –∫–∞–∫ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ MT5                                 |
| bid/ask             | —Ç–µ–∫—É—â–∏–µ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ MT5                              |
| spread              | `ask - bid`                                        |
| symbol/tf           | —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç                                   |

‚ùó –ï—Å–ª–∏ –±–∞—Ä **–Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω MT5**, Observer **–ù–ï –æ–±—è–∑–∞–Ω ‚Äú–∏–∑–æ–±—Ä–µ—Ç–∞—Ç—å‚Äù OHLC**.
–î–æ–ø—É—Å—Ç–∏–º–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–≤–Ω—ã–º–∏ —Ç–µ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç MT5 (–≤–∫–ª—é—á–∞—è 0, –µ—Å–ª–∏ —ç—Ç–æ —Ñ–∞–∫—Ç MT5).

---

### 3.2 `Snapshot.constraints`

| –ü–æ–ª–µ                          | –ü—Ä–∞–≤–∏–ª–æ                                  |
| ----------------------------- | ---------------------------------------- |
| is_trading_allowed            | **–∫–ª—é—á–µ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥—ã** |
| min_lot / lot_step / min_stop | –∫–∞–∫ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ –±—Ä–æ–∫–µ—Ä–æ–º                  |

‚ùó –ï—Å–ª–∏ —Ç–æ—Ä–≥–æ–≤–ª—è –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã,
`is_trading_allowed=false` —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç **—Ñ–∞–∫—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥—ã**,
–±–µ–∑ –≤–≤–µ–¥–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –∏ –±–µ–∑ –ø–æ–¥–º–µ–Ω—ã –¥—Ä—É–≥–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

---

### 3.3 `Snapshot.position`

–ò—Å—Ç–æ—á–Ω–∏–∫: —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—á—ë—Ç–∞.

| –ü–æ–ª–µ         | –ü—Ä–∞–≤–∏–ª–æ                |
| ------------ | ---------------------- |
| has_position | —Ñ–∞–∫—Ç –Ω–∞–ª–∏—á–∏—è –ø–æ–∑–∏—Ü–∏–∏   |
| direction    | +1 / -1 / 0            |
| volume       | —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ–±—ä—ë–º      |
| entry_price  | —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞ |
| floating_pnl | –∫–∞–∫ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ MT5     |

–ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ—Ç ‚Üí –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–µ–º–∏, –∫–æ—Ç–æ—Ä—ã–µ MT5 —Ä–µ–∞–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–æ–∑–∏—Ü–∏–∏ (–æ–±—ã—á–Ω–æ 0, –Ω–æ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é).

---

### 3.4 `Snapshot.time` (—É—Ç–æ—á–Ω–µ–Ω–æ)

| –ü–æ–ª–µ                   | –ü—Ä–∞–≤–∏–ª–æ           |
| ---------------------- | ----------------- |
| timestamp              | —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è MT5 |
| is_new_bar             | —Ñ–∞–∫—Ç —Å–º–µ–Ω—ã –±–∞—Ä–∞   |
| bars_since_entry       | —Å–º. –Ω–∏–∂–µ          |
| bars_since_last_action | —Å–º. –Ω–∏–∂–µ          |

---

## 4. –ü—Ä–∞–≤–∏–ª–∞ —Å—á—ë—Ç—á–∏–∫–æ–≤ –≤—Ä–µ–º–µ–Ω–∏ (–ù–û–†–ú–ê–¢–ò–í–ù–û)

### 4.1 `bars_since_entry`

Observer **–ù–ï –∑–Ω–∞–µ—Ç –ø—Ä–æ Intent/Decision/Execution**.

`entry` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–ò–°–ö–õ–Æ–ß–ò–¢–ï–õ–¨–ù–û –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º —Ñ–∞–∫—Ç–æ–º**:

```
Snapshot.position.has_position : false ‚Üí true
```

–ü—Ä–∞–≤–∏–ª–∞:

* –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ `false ‚Üí true` ‚Üí `bars_since_entry = 0`
* –¥–∞–ª–µ–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è **–Ω–∞ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º –±–∞—Ä–µ**
* –µ—Å–ª–∏ `has_position=false` ‚Üí –∑–Ω–∞—á–µ–Ω–∏–µ = 0

---

### 4.2 `bars_since_last_action`

`action` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–¢–û–õ–¨–ö–û –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –Ω–∞–±–ª—é–¥–∞–µ–º–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏**:

–°—á–∏—Ç–∞–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ–º –ª—é–±–æ–µ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö —Å–æ–±—ã—Ç–∏–π:

* –∏–∑–º–µ–Ω–µ–Ω–∏–µ `has_position`
* –∏–∑–º–µ–Ω–µ–Ω–∏–µ `position.volume`
* –∏–∑–º–µ–Ω–µ–Ω–∏–µ `position.direction`

–ü—Ä–∞–≤–∏–ª–∞:

* –ø—Ä–∏ –ª—é–±–æ–º —Ç–∞–∫–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ ‚Üí `bars_since_last_action = 0`
* –¥–∞–ª–µ–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è **–Ω–∞ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º –±–∞—Ä–µ**
* –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ / —Ä–µ—Å—Ç–∞—Ä—Ç–µ Observer:

  * —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è ‚Äú–Ω–∞—á–∞–ª—å–Ω—ã–º —Ñ–∞–∫—Ç–æ–º‚Äù
  * —Å—á—ë—Ç—á–∏–∫ —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å 0

‚ùó Observer **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Feedback / Decision / ExecutionResult**.

---

## 5. –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

Observer **–ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**.

–ü—Ä–∏–Ω—Ü–∏–ø—ã:

* –µ—Å–ª–∏ MT5 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 ‚Üí 0 —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ñ–∞–∫—Ç–æ–º
* –µ—Å–ª–∏ —Ç–æ—Ä–≥–æ–≤–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ ‚Üí `is_trading_allowed=false`
* Snapshot **–≤—Å–µ–≥–¥–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è**, –Ω–æ **–±–µ–∑ –≤—ã–¥—É–º–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

Observer:

* –Ω–µ –ø–∞–¥–∞–µ—Ç
* –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç
* –Ω–µ —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç

–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–í–ù–ï Observer**
—á–µ—Ä–µ–∑ **Visual Tester Snapshot Viewer**.

---

## 6. –í–∏–∑—É–∞–ª—å–Ω–∞—è –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (—É—Ç–æ—á–Ω–µ–Ω–∏–µ)

**Visual Tester:** Snapshot Viewer
**–¢–∏–ø:** `Snapshot` (–≤—ã—Ö–æ–¥ Observer)

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

* –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Snapshot ‚Üî –≥—Ä–∞—Ñ–∏–∫—É MT5
* –≤—ã—è–≤–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö
* –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å—Ä–µ–¥—ã (`is_trading_allowed=false`)

Visual Tester ‚Äî **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å–ø–æ—Å–æ–± –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ Observer**.

---

## 7. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω—ã)

Observer v1.0 –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω, –µ—Å–ª–∏:

* ‚ùè Snapshot –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
* ‚ùè –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ —Ñ–∞–∫—Ç—ã MT5
* ‚ùè —Å—á—ë—Ç—á–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –¢–û–õ–¨–ö–û –∏–∑ position + bar
* ‚ùè –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏/—Ä–∏—Å–∫–∞
* ‚ùè –∑–∞–º–µ–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–æ–∫ Observer

---

## 8. –ü—Ä–∞–≤–∏–ª–æ –∑–∞–º–æ—Ä–æ–∑–∫–∏

–ü–æ—Å–ª–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:

> **Observer v1.0 –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç—Å—è.**

–ò–∑–º–µ–Ω–µ–Ω–∏—è:

* —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π
* –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è SSP / Lexicon

---

**END OF TECH SPEC ‚Äî Observer v1.0 (REVISED)**
